---
title: 'Proje Rapor : Merve Nur Çelik 210401069'
output: html_document
---


# Q1 : Problem tanımı

Şirketimizin **UMBRELLA BANKASI** müşteri kaybı yaşıyor. Müşterilerimiz kredi kartlarının kapatılmasını sıklıkla talep ediyor. Bu durumun önüne 
geçebilmek ve müşterilere yeni teklifler yapabilmek istiyoruz.


# Q2 : Proje Amacı
[Banka Müşterileri](https://www.kaggle.com/datasets/sakshigoyal7/credit-card-customers) adlı kaggle veri setini kullanarak iş problemini müşteri demografik verileri, gelir düzeyi, eğitim seviyeleri ve diğer ilgili faktörleri inceleyerek müşteri profillerini oluşturmak üzere yaş, gelir, kredi kartı türü gibi özelliklere göre segmentasyon yaparak ayrılma oranlarını analiz etmek istiyoruz. Bu analizlerle beraber müşterilere ayrılmamalarını sağlayacak kart teklifleri sunacağız. Müşteri kaybı ve kredi kartı kullanımından vazgeçilmesi durumunu azaltmak istiyoruz . Böylece bankamızın kârını arttırmayı planlıyoruz. 


# Q3 : Veri seti keşifsel analizi 


```{r echo=FALSE, message=FALSE, warning=FALSE}
#Kütüphanenin eklenmesi 
library(readr)
library(dplyr)
library(ggplot2)

# Veri Setinin Yüklenmesi
filename <- "Bank.csv"
path <- file.path("~/Bank.csv")
myDF <- readr::read_csv(path)


```


    Veri seti Kaggle web sitesinden indirilmiş ve readr::read_csv() fonksiyonu kullanılarak bir veri çerçevesine (myDF) yüklenmiştir.
 
```{r echo=FALSE, message=FALSE, warning=FALSE}
myDF
```
 Veri setinin ilk birkaç satırı ekrana yazdırılmıştır.

  Veri seti Kaggle web sitesinden indirilmiştir ve **readr::read_csv()** fonksiyonu kullanılarak **`r class(myDF)[[1]]`** tipinde bir değişkene ithal edilmiştir. Veri boyutları aşağıdaki gibidir :

- Satir sayisi : `r nrow(myDF)`
- Sutün sayisi : `r ncol(myDF)`

Veri setinin ön görsellemesi aşağıda verilmiştir.

```{r echo=FALSE, message=FALSE, warning=FALSE}
myDF
```

    Veri tipleri numeric ve character olarak değişmektedir. 

```{r echo=FALSE, message=FALSE, warning=FALSE}

```

### Önemli Satırlar ve Sütunlar

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Kaggle platformunda paylaşılan bir veri setidir.

# Önemli Satırlar ve Sütunlar
important_columns <- c("CLIENTNUM", "Attrition_Flag", "Customer_Age", "Gender", 
                        "Dependent_count", "Education_Level", "Marital_Status", 
                        "Income_Category", "Card_Category", "Months_on_book", 
                        "Total_Relationship_Count", "Months_Inactive_12_mon", 
                        "Contacts_Count_12_mon", "Credit_Limit", 
                        "Total_Revolving_Bal", "Avg_Open_To_Buy")

important_data <- myDF[, important_columns]


```

    Analizde kullanılacak olan önemli sütunlar belirlenmiş ve bu sütunlara ait veriler important_data isimli bir veri çerçevesine atanmıştır.

### Eksik veri kontrolü

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Problemler, Eksik Veriler ve Yanlış/Manasız Veriler
missing_data <- colSums(is.na(important_data))
print(missing_data)

```

    important_data veri çerçevesinde eksik veri kontrolü yapılmış ve her sütundaki eksik veri sayıları gösterilmiştir. Görüldüğü üzere eksik veri bulunmamaktadır.


### Yaş Dağılımı Histogramı

```{r echo=FALSE, message=FALSE, warning=FALSE}


ggplot(myDF, aes(x = Customer_Age)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Yaş Dağılımı", x = "Yaş", y = "Frekans") +
  theme_minimal()

```

    Müşterilerin yaşlarının dağılımını gösteren bir histogramdır.

### Cinsiyete Göre Dağılım

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(myDF, aes(x = Gender, fill = Gender)) +
  geom_bar() +
  labs(title = "Cinsiyete Göre Dağılım", x = "Cinsiyet", y = "Frekans") +
  theme_minimal()

```

    Müşteri cinsiyetlerine göre dağılımı gösteren bir bar grafiğidir.

### Eğitim Seviyesine Göre Dağılım

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(myDF, aes(x = Education_Level, fill = Education_Level)) +
  geom_bar() +
  labs(title = "Eğitim Seviyesine Göre Dağılım", x = "Eğitim Seviyesi", y = "Frekans") +
  theme_minimal()
```

    Müşteri eğitim seviyelerine göre dağılımı gösteren bir bar grafiği.

### Kredi Kartı Kategorilerine Göre Dağılım

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(myDF, aes(x = Card_Category, fill = Card_Category)) +
  geom_bar() +
  labs(title = "Kredi Kartı Kategorilerine Göre Dağılım", x = "Kredi Kartı Kategorisi", y = "Frekans") +
  theme_minimal()
```

    Kredi kartı kategorilerine göre müşteri dağılımını gösteren bir bar grafiği.

### Müşteri Attrition Durumu

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(myDF, aes(x = Attrition_Flag, fill = Attrition_Flag)) +
  geom_bar() +
  labs(title = "Müşteri Attrition Durumu", x = "Attrition Durumu", y = "Frekans") +
  theme_minimal()


```

    Müşteri attrition durumunu gösteren bir bar grafiği.

### Gelir Kategorisi ve Cinsiyet Dağılımı

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(myDF, aes(x = Income_Category, fill = Gender)) +
  geom_bar(position = "dodge") +
  labs(title = "Gelir Kategorisi ve Cinsiyet Dağılımı", x = "Gelir Kategorisi", y = "Frekans", fill = "Cinsiyet") +
  theme_minimal()
```

    Gelir kategorisi ve cinsiyetin kombinasyonuna göre müşteri dağılımını gösteren bir bar grafiği.

### Gelir Kategorisi ve Kart Türü Dağılımı
```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(myDF, aes(x = Income_Category, fill = Card_Category)) +
  geom_bar(position = "dodge") +
  labs(title = "Gelir Kategorisi ve Kart Türü Dağılımı", x = "Gelir Kategorisi", y = "Frekans", fill = "Kart Türü") +
  theme_minimal()

```

    Gelir kategorisi ve kart türünün kombinasyonuna göre müşteri dağılımını gösteren bir bar grafiği.


### Yaşa Göre Gelir Kategorisi Nokta Grafikleri

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(important_data, aes(x = Income_Category, y = Customer_Age, color = Income_Category)) +
  geom_point(position = position_jitter(h = 0.2, w = 0.3), alpha = 0.7, size = 2) +
  stat_summary(fun = "mean", geom = "point", shape = 18, size = 3, color = "black") +
  labs(title = "Yaşa Göre Gelir Kategorisi Nokta Grafikleri", x = "Gelir Kategorisi", y = "Yaş") +
  theme_minimal()
```

    Yaşa göre gelir kategorisinin nokta grafikleri, her bir kategorinin ortalama yaşını da gösterir.

# Q4: Veri Seti Ön İşlemesi

```{r echo=FALSE, message=FALSE, warning=FALSE}
myDF$Income_Category <- as.numeric(factor(myDF$Income_Category, levels = unique(myDF$Income_Category)))
```

    factor() fonksiyonu, "Income_Category" sütununu faktör (kategorik) bir değişken olarak dönüştürür.

### Kategorik değişkenlerin factor'a çevrilmesi
```{r echo=FALSE, message=FALSE, warning=FALSE}

myDF$Education_Level <- as.factor(myDF$Education_Level)
myDF$Marital_Status <- as.factor(myDF$Marital_Status)
myDF$Card_Category <- as.factor(myDF$Card_Category)
```

    "Education_Level,"  "Marital_Status," ve "Card_Category" sütunları faktör tipine dönüştürülmüştür.

### Aykırı değerleri belirleme
```{r echo=FALSE, message=FALSE, warning=FALSE}

outliers <- boxplot.stats(myDF$Customer_Age)$out
```

     "Customer_Age" sütunundaki aykırı değerler belirlenmiştir.

### Aykırı değerleri ortalama ile değiştirme
```{r echo=FALSE, message=FALSE, warning=FALSE}

myDF$Customer_Age[myDF$Customer_Age %in% outliers] <- mean(myDF$Customer_Age, na.rm = TRUE)
```

    "Customer_Age" sütunundaki aykırı değerler belirlenmiş ve bunlar ortalama ile değiştirilmiştir.

### "Income_Category" sütununu faktör olarak dönüştürme

```{r echo=FALSE, message=FALSE, warning=FALSE}

myDF$Income_Category <- as.factor(myDF$Income_Category)


```
### "Income_Category" sütununun değerlerini kontrol etme

```{r echo=FALSE, message=FALSE, warning=FALSE}

levels(myDF$Income_Category)
```

### Dönüşüm sonrası data frame'i gösterme
```{r echo=FALSE, message=FALSE, warning=FALSE}

head(myDF)

```

# Q5: Veri analizi 

### Gelir segmentleri ve kredi kartı türleri arasındaki ilişkiyi görselleştirme

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(myDF, aes(x = Income_Category, fill = Card_Category)) +
  geom_bar(position = "dodge") +
  labs(title = "Gelir Segmentleri ve Kredi Kartı Türleri Dağılımı", x = "Gelir Kategorisi", y = "Frekans", fill = "Kredi Kartı Türü") +
  theme_minimal()

```
    
    Bu grafik, gelir segmentleri ve kredi kartı türleri arasındaki ilişkiyi görselleştirir.
    X ekseni gelir kategorilerini, Y ekseni frekansı ve renk ise kredi kartı türünü temsil eder.
    
### Kredi Limiti Dağılımı

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(myDF, aes(x = Credit_Limit)) +
  geom_histogram(binwidth = 1000, fill = "orange", color = "black") +
  labs(title = "Kredi Limiti Dağılımı", x = "Kredi Limiti", y = "Frekans") +
  theme_minimal()


```
   
    Bu histogram, müşterilerin kredi limitlerinin genel dağılımını gösterir.
    X ekseni kredi limitini, Y ekseni frekansı temsil eder.
    
### Müşteri yaş grupları oluşturma

```{r echo=FALSE, message=FALSE, warning=FALSE}
myDF$Age_Group <- cut(myDF$Customer_Age, breaks = c(0, 30, 40, 50, 60, Inf), labels = c("0-30", "31-40", "41-50", "51-60", "60+"))


```
 
    Burada müşteri yaş grupları kategorize edilmiştir.
  
### Her bir yaş grubu için "Credit_Limit" değişkeninin analizi

```{r echo=FALSE, message=FALSE, warning=FALSE}

credit_limit_by_age_group <- myDF %>%
  group_by(Age_Group) %>%
  summarise(mean_credit_limit = mean(Credit_Limit, na.rm = TRUE))

print(credit_limit_by_age_group)
```

    Bu analiz, müşterilerin yaş gruplarına göre kredi limitlerinin ortalama değerlerini gösterir.
    Her yaş grubunun kredi limitini temsil eden bir tablo sunulmuştur.


### Ortalama Kredi Limiti Hesaplama ve Değerlendirme

```{r echo=FALSE, message=FALSE, warning=FALSE}
mean_credit_limit <- mean(myDF$Credit_Limit, na.rm = TRUE)
cat("Ortalama Kredi Limiti:", mean_credit_limit, "\n")


```

    Bu işlem, tüm müşterilerin ortalama kredi limitini hesaplar ve ekrana yazdırır.

### Kredi Kartı Türlerine Göre Kredi Limiti Ortalaması

```{r echo=FALSE, message=FALSE, warning=FALSE}

credit_limit_by_card_category <- myDF %>%
  group_by(Card_Category) %>%
  summarise(mean_credit_limit = mean(Credit_Limit, na.rm = TRUE))

print(credit_limit_by_card_category)
```
  
    Bu analiz, kredi kartı türlerine göre kredi limitlerinin ortalama değerlerini gösterir.
    Her kredi kartı türünün kredi limitini temsil eden bir tablo sunulmuştur.

### Gelir segmenti bazında toplam Döner bakiye histogram ve ortalama

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(myDF, aes(x = Total_Revolving_Bal, fill = Income_Category)) +
  geom_histogram(binwidth = 500, position = "dodge") +
  labs(title = "Gelir Segmentine Göre Toplam Döner Bakiye Dağılımı", x = "Total_Revolving_Bal", y = "Frekans", fill = "Gelir Kategorisi") +
  theme_minimal()

```
   
    Bu histogram, gelir segmentlerine göre müşterilerin toplam döner bakiyelerini gösterir.
    X ekseni toplam döner bakiyeyi, Y ekseni frekansı ve gelir segmentini temsil eder.
    
### Eğitim Seviyesi ve Medeni Durum Analizi

```{r echo=FALSE, message=FALSE, warning=FALSE}
education_marital_analysis <- myDF %>%
  group_by(Education_Level, Marital_Status) %>%
  summarise(count = n())

print(education_marital_analysis)
```
   
    Bu analiz, müşterilerin eğitim seviyelerine ve medeni durumlarına göre sayıları gösterir.
    Eğitim seviyeleri ve medeni durumları içeren bir tablo sunulmuştur.

### Sentetik olarak "Kredi Kartı Kullanma Sıklığı" oluşturma

```{r echo=FALSE, message=FALSE, warning=FALSE}
set.seed(123)  # Rassal sayıların tekrarlanabilirliği için seed ayarı
myDF$Credit_Card_Usage_Frequency <- rnorm(nrow(myDF), mean = 10, sd = 5)


```
   
    Bu sentetik değişken, müşterilerin kredi kartı kullanma sıklığını simüle etmek amacıyla oluşturulmuştur.
    Rassal sayılar kullanılarak elde edilmiş ve olumsuz değerler sıfıra çevrilmiştir.
    İlk 10 satırı gösteren bir liste sunulmuştur.

### Olumsuz değerleri sıfıra çevirme

```{r echo=FALSE, message=FALSE, warning=FALSE}
myDF$Credit_Card_Usage_Frequency[myDF$Credit_Card_Usage_Frequency < 0] <- 0

```
            
    Burada Credit_Card_Usage_Frequency değeri için 0'dan küçük değerler 0'a çevirilir.

### Yeni sentetik değişkeni gösterme

```{r echo=FALSE, message=FALSE, warning=FALSE}
head(myDF)

```

  Eklenti yapılan sentetik değişken "Kredi Kartı Kullanma Sıklığı **(Credit_Card_Usage_Frequency)**" ile ilgili  tanıtım aşağıda verilmiştir:

Bu sentetik değişken, rassal sayı üretimi kullanılarak oluşturulmuştur.
**set.seed(123)** komutu, rassal sayıların tekrarlanabilirliğini sağlamak için kullanılmıştır. Bu, aynı seed değeri kullanıldığında her zaman aynı rassal sayıların üretilmesini sağlar.
    **rnorm(nrow(myDF), mean = 10, sd = 5)** komutu, normal dağılıma sahip rassal sayıları üretir. Bu durumda, ortalama (mean) değeri 10, standart sapma (sd) değeri 5 olarak belirlenmiştir.
    **myDF$Credit_Card_Usage_Frequency[myDF$Credit_Card_Usage_Frequency < 0] <- 0** komutu, olumsuz değerleri sıfıra çevirir. Bu işlem, kullanım sıklığı negatif olan olası değerlere karşı bir önlem olarak eklenmiştir.
    head(myDF) komutu, veri setinin ilk birkaç satırını gösterir ve eklenen sentetik değişkeni görüntüler.

Bu sentetik değişken, müşterilerin kredi kartı kullanma sıklığını temsil eder. Ortalama değeri 10 ve standart sapması 5 olarak belirlenmiştir. Bu değişken, müşterilerin kredi kartı kullanma alışkanlıklarını simüle etmek amacıyla eklenmiştir.


### Credit_Card_Usage_Frequency için ilk 10 satırı gösterme
```{r echo=FALSE, message=FALSE, warning=FALSE}

head(myDF$Credit_Card_Usage_Frequency, 10)
```

